<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·é¥®é£ŸåŠ©æ‰‹ | UIé‡æ„ç‰ˆ</title>
    <style>
        /* ==================== 
           1. å…¨å±€åŸºç¡€æ ·å¼ (Global) - CSSä¸ä¸Šä¸€æ¬¡ä¸€è‡´ï¼Œä¿è¯ç¾è§‚åº¦
           ==================== */
        :root {
            --primary: #4CAF50;
            --primary-dark: #388E3C;
            --accent: #FF9800;
            --bg: #F0F4F8;
            --card-bg: #FFFFFF;
            --text-main: #2c3e50;
            --text-sub: #7f8c8d;
            --shadow: 0 10px 20px rgba(0,0,0,0.08);
            --radius: 16px;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1, h2, h3 { margin: 0; font-weight: 600; }
        
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            transition: transform 0.3s ease;
        }
        
        .card:hover { transform: translateY(-5px); }

        /* ==================== 
           2. è®¡ç®—å™¨æ ·å¼ (Calculator) - ä¿æŒä¸€è‡´
           ==================== */
        .calc-header { text-align: center; margin-bottom: 25px; }
        .calc-header h2 { color: var(--primary); margin-bottom: 8px; }
        .calc-header p { color: var(--text-sub); font-size: 0.9em; }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .gender-group { grid-column: span 2; display: flex; gap: 15px; justify-content: center; }
        .radio-label {
            flex: 1; text-align: center; padding: 12px; border: 2px solid #e0e0e0;
            border-radius: 10px; cursor: pointer; transition: all 0.3s; font-weight: bold;
            color: var(--text-sub);
        }
        .radio-label input { display: none; }
        
        .radio-label:has(input:checked) {
            border-color: var(--primary); background-color: #e8f5e9; color: var(--primary);
        }

        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-size: 0.85em; color: var(--text-sub); margin-bottom: 5px; }
        
        .styled-input, .styled-select {
            padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1em;
            background: #fafafa; outline: none; transition: border 0.3s;
        }
        .styled-input:focus, .styled-select:focus { border-color: var(--primary); background: #fff; }
        
        .full-width { grid-column: span 2; }

        .btn-calc {
            width: 100%; padding: 16px; background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white; border: none; border-radius: 30px; font-size: 1.1em; font-weight: bold;
            cursor: pointer; margin-top: 20px; box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-calc:active { transform: scale(0.98); }

        /* ==================== 
           3. ç»“æœå±•ç¤ºæ ·å¼ (Results) - ä¿æŒä¸€è‡´
           ==================== */
        .result-section {
            display: none;
            text-align: center;
            animation: fadeIn 0.8s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .calories-display {
            background: var(--primary); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;
        }
        .big-number { font-size: 2.5em; font-weight: 800; line-height: 1.2; }
        
        .nutrients-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .nutrient-box { background: #f9f9f9; padding: 15px 5px; border-radius: 10px; }
        .nutrient-val { display: block; font-size: 1.2em; font-weight: bold; color: var(--text-main); }
        .nutrient-lbl { font-size: 0.8em; color: var(--text-sub); }

        .prot-color { color: #3498db; }
        .fat-color { color: #f1c40f; }
        .carb-color { color: #e67e22; }

        /* ==================== 
           4. é£Ÿç‰©å¯¼èˆªæ ·å¼ (Food Nav) - ä¿æŒä¸€è‡´
           ==================== */
        .nav-wrapper { overflow-x: auto; white-space: nowrap; padding-bottom: 10px; scrollbar-width: none; }
        .nav-wrapper::-webkit-scrollbar { display: none; }

        .food-tabs { display: inline-flex; gap: 10px; }
        
        .tab-btn {
            padding: 10px 20px; background: transparent; border: 2px solid #e0e0e0;
            border-radius: 25px; color: var(--text-sub); cursor: pointer; font-weight: 600;
            transition: all 0.3s;
        }

        .tab-btn.active, .tab-btn:hover {
            border-color: var(--primary); background: var(--primary);
            color: white; box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
        }

        .food-content {
            margin-top: 20px; padding: 20px; background: #f9f9f9;
            border-radius: 10px; border-left: 5px solid var(--primary);
        }

    </style>
</head>
<body>

<div class="container">

    <section class="card">
        <div class="calc-header">
            <h2>ğŸ¥— è¥å…»éœ€æ±‚è®¡ç®—å™¨</h2>
            <p>åŸºäºæ‚¨çš„èº«ä½“æ•°æ®ï¼Œç§‘å­¦è§„åˆ’æ¯æ—¥æ‘„å…¥</p>
        </div>

        <form id="calcForm" onsubmit="event.preventDefault(); showResults();">
            <div class="form-grid">
                
                <div class="gender-group">
                    <label class="radio-label">
                        <input type="radio" name="gender" value="male" id="genderMale" checked>
                        <span>ğŸ‘¨ ç”·å£«</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="gender" value="female" id="genderFemale">
                        <span>ğŸ‘© å¥³å£«</span>
                    </label>
                </div>

                <div class="input-group">
                    <label>å¹´é¾„ (å²)</label>
                    <input type="number" class="styled-input" id="ageInput" placeholder="25" required min="10">
                </div>
                <div class="input-group">
                    <label>ä½“é‡ (kg)</label>
                    <input type="number" class="styled-input" id="weightInput" placeholder="60" required min="30">
                </div>
                <div class="input-group full-width">
                    <label>èº«é«˜ (cm)</label>
                    <input type="number" class="styled-input" id="heightInput" placeholder="170" required min="100">
                </div>
                
                <div class="input-group full-width">
                    <label>æ—¥å¸¸æ´»åŠ¨å¼ºåº¦</label>
                    <select class="styled-select" id="activitySelect">
                        <option value="1.2">ğŸ›‹ï¸ ä¹…åä¸åŠ¨ (åŠå…¬å®¤å·¥ä½œ)</option>
                        <option value="1.375">ğŸš¶â€â™‚ï¸ è½»åº¦æ´»åŠ¨ (æ¯å‘¨è¿åŠ¨1-3æ¬¡)</option>
                        <option value="1.55">ğŸƒâ€â™‚ï¸ ä¸­åº¦æ´»åŠ¨ (æ¯å‘¨è¿åŠ¨3-5æ¬¡)</option>
                        <option value="1.725">ğŸ‹ï¸â€â™‚ï¸ é«˜å¼ºåº¦æ´»åŠ¨ (æ¯å¤©è¿åŠ¨)</option>
                    </select>
                </div>
            </div>

            <button class="btn-calc" type="submit">å¼€å§‹è®¡ç®— / LET'S DO IT</button>
        </form>
    </section>

    <section id="resultCard" class="card result-section">
        <h3>âœ¨ æ‚¨çš„ä¸“å±è¥å…»å»ºè®®</h3>
        <p style="color:#666; font-size:0.9em; margin-bottom:15px;">ç»´æŒå½“å‰ä½“é‡æ¯æ—¥æ¨èæ‘„å…¥ï¼š</p>
        
        <div class="calories-display">
            <span class="big-number" id="tdeeResult">0</span> kcal
            <div style="font-size:0.8em; opacity:0.8;">æ¯æ—¥çƒ­é‡</div>
        </div>

        <div class="nutrients-grid">
            <div class="nutrient-box">
                <span class="nutrient-val prot-color" id="proteinResult">0g</span>
                <span class="nutrient-lbl">è›‹ç™½è´¨</span>
            </div>
            <div class="nutrient-box">
                <span class="nutrient-val fat-color" id="fatResult">0g</span>
                <span class="nutrient-lbl">è„‚è‚ª</span>
            </div>
            <div class="nutrient-box">
                <span class="nutrient-val carb-color" id="carbResult">0g</span>
                <span class="nutrient-lbl">ç¢³æ°´</span>
            </div>
        </div>
    </section>

    <section class="card">
        <h3 style="margin-bottom: 15px;">ğŸ é£Ÿç‰©åˆ†ç±»æŒ‡å—</h3>
        
        <div class="nav-wrapper">
            <div class="food-tabs">
                <button class="tab-btn active" onclick="switchTab(this, 'all')">å…¨éƒ¨</button>
                <button class="tab-btn" onclick="switchTab(this, 'grain')">ğŸŒ¾ è°·è–¯ç±»</button>
                <button class="tab-btn" onclick="switchTab(this, 'vege')">ğŸ¥¦ è”¬æœç±»</button>
                <button class="tab-btn" onclick="switchTab(this, 'meat')">ğŸ¥© ç•œç¦½è‚‰è›‹</button>
                <button class="tab-btn" onclick="switchTab(this, 'soy')">ğŸ¥œ å¤§è±†åšæœ</button>
            </div>
        </div>

        <div id="foodContent" class="food-content">
            <strong>æ¨èæ‘„å…¥ï¼š</strong> è°·è–¯ç±»æ˜¯è†³é£Ÿèƒ½é‡çš„ä¸»è¦æ¥æºï¼Œæ¯å¤©å»ºè®®æ‘„å…¥ 250g - 400gã€‚
            <br><span style="color:#888; font-size:0.9em;">(ç‚¹å‡»ä¸Šæ–¹æ ‡ç­¾å¯åˆ‡æ¢å†…å®¹)</span>
        </div>
    </section>

</div>

<script>
    // **æ›´æ–°ï¼šæ·»åŠ æ•°å­—åŠ¨ç”»å‡½æ•°**
    function animateValue(id, start, end, duration) {
        const obj = document.getElementById(id);
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            // åªå–æ•´æ•°éƒ¨åˆ†è¿›è¡ŒåŠ¨ç”»
            obj.innerText = Math.floor(progress * (end - start) + start).toLocaleString() + (id.includes('Result') ? 'g' : '');
            if (progress < 1) {
                window.requestAnimationFrame(step);
            } else {
                 // ç¡®ä¿æœ€ç»ˆç»“æœæ˜¯ç²¾ç¡®å€¼ï¼ˆå…‹æ•°ä¿ç•™ä¸€ä½å°æ•°ï¼Œå¡è·¯é‡Œå–æ•´ï¼‰
                 if (!id.includes('Result')) {
                    obj.innerText = Math.round(end).toLocaleString();
                 } else {
                    obj.innerText = end.toFixed(1) + 'g';
                 }
            }
        };
        window.requestAnimationFrame(step);
    }
    
    // **æ ¸å¿ƒè®¡ç®—å…¬å¼**
    function showResults() {
        // 1. è·å–è¾“å…¥å€¼
        const age = parseFloat(document.getElementById('ageInput').value);
        const weight = parseFloat(document.getElementById('weightInput').value); // W (kg)
        const height = parseFloat(document.getElementById('heightInput').value); // H (cm)
        const activityFactor = parseFloat(document.getElementById('activitySelect').value);
        const genderMale = document.getElementById('genderMale').checked;
        
        // åŸºæœ¬è¾“å…¥æ ¡éªŒ
        if (isNaN(age) || isNaN(weight) || isNaN(height)) {
            alert("è¯·å¡«å†™å®Œæ•´çš„å¹´é¾„ã€ä½“é‡å’Œèº«é«˜ä¿¡æ¯ï¼");
            return;
        }

        // 2. è®¡ç®— BMR (Mifflin-St Jeor Equation)
        let BMR;
        if (genderMale) {
            // ç”·æ€§: BMR = (10 Ã— W) + (6.25 Ã— H) - (5 Ã— A) + 5
            BMR = (10 * weight) + (6.25 * height) - (5 * age) + 5;
        } else {
            // å¥³æ€§: BMR = (10 Ã— W) + (6.25 Ã— H) - (5 Ã— A) - 161
            BMR = (10 * weight) + (6.25 * height) - (5 * age) - 161;
        }
        
        // 3. è®¡ç®— TDEE (æ¯æ—¥æ€»çƒ­é‡æ¶ˆè€—)
        const TDEE = BMR * activityFactor;
        
        // 4. è®¡ç®—å®é‡è¥å…»ç´  (é‡‡ç”¨æ ‡å‡†å¥åº·æ¯”ä¾‹)
        // æ¯”ä¾‹åˆ†é…: è›‹ç™½è´¨ 25%, è„‚è‚ª 25%, ç¢³æ°´ 50%
        // è¥å…»ç´ çƒ­é‡: è›‹ç™½è´¨/ç¢³æ°´ = 4 kcal/g, è„‚è‚ª = 9 kcal/g

        // è›‹ç™½è´¨ (Protein): 25% of TDEE
        const proteinCal = TDEE * 0.25;
        const proteinGrams = proteinCal / 4; // g = kcal / 4

        // è„‚è‚ª (Fat): 25% of TDEE
        const fatCal = TDEE * 0.25;
        const fatGrams = fatCal / 9; // g = kcal / 9

        // ç¢³æ°´ (Carbs): 50% of TDEE
        const carbCal = TDEE * 0.50;
        const carbGrams = carbCal / 4; // g = kcal / 4

        
        // 5. æ›´æ–° UI å¹¶æ‰§è¡ŒåŠ¨ç”»
        const resultCard = document.getElementById('resultCard');
        resultCard.style.display = 'block';
        resultCard.scrollIntoView({ behavior: 'smooth' }); // å¹³æ»‘æ»šåŠ¨åˆ°ç»“æœ

        // ä½¿ç”¨åŠ¨ç”»æ˜¾ç¤ºç»“æœ
        const duration = 1500; // åŠ¨ç”»æ—¶é•¿1.5ç§’
        // TDEE (å¡è·¯é‡Œ)
        animateValue('tdeeResult', 0, TDEE, duration);
        // è›‹ç™½è´¨
        animateValue('proteinResult', 0, proteinGrams, duration);
        // è„‚è‚ª
        animateValue('fatResult', 0, fatGrams, duration);
        // ç¢³æ°´
        animateValue('carbResult', 0, carbGrams, duration);
    }

    // å¯¼èˆªåˆ‡æ¢é€»è¾‘ (ä¸ä¸Šä¸€æ¬¡ä¿æŒä¸€è‡´)
    function switchTab(btn, category) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const content = document.getElementById('foodContent');
        const textMap = {
            'all': 'å‡è¡¡é¥®é£Ÿæ˜¯å¥åº·çš„å…³é”®ï¼Œè¯·åˆç†æ­é…å„ç±»é£Ÿç‰©ã€‚',
            'grain': 'æ¨èæ‘„å…¥ï¼šè°·è–¯ç±»æ˜¯èƒ½é‡ä¸»è¦æ¥æºï¼Œä¼˜é€‰å…¨è°·ç‰©ï¼ˆç³™ç±³ã€ç‡•éº¦ï¼‰ã€‚',
            'vege': 'æ¨èæ‘„å…¥ï¼šæ¯å¤©è‡³å°‘300gè”¬èœï¼Œæ·±è‰²è”¬èœåº”å ä¸€åŠä»¥ä¸Šã€‚',
            'meat': 'æ¨èæ‘„å…¥ï¼šä¼˜å…ˆé€‰æ‹©é±¼è™¾ç±»ï¼Œå…¶æ¬¡æ˜¯å»çš®ç¦½è‚‰ï¼Œå°‘åƒè‚¥è‚‰ã€‚',
            'soy': 'æ¨èæ‘„å…¥ï¼šåšæœå¯Œå«å¥åº·æ²¹è„‚ï¼Œä½†çƒ­é‡é«˜ï¼Œæ¯å¤©ä¸€å°æŠŠå³å¯ã€‚'
        };
        content.innerHTML = `<strong>${btn.innerText}ï¼š</strong> ${textMap[category]}`;
    }
</script>

</body>
</html>