<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·é¥®é£ŸåŠ©æ‰‹ | é£Ÿç‰©æ¨è</title>
    <style>
        /* CSS æ ·å¼ä¸ä¸Šä¸€æ¬¡æä¾›çš„ä»£ç åŸºæœ¬ä¸€è‡´ï¼Œä½†æ–°å¢äº†é£Ÿç‰©æ¨èåˆ—è¡¨çš„æ ·å¼ */
        :root {
            --primary: #4CAF50;
            --primary-dark: #388E3C;
            --accent: #FF9800;
            --bg: #F0F4F8;
            --card-bg: #FFFFFF;
            --text-main: #2c3e50;
            --text-sub: #7f8c8d;
            --shadow: 0 10px 20px rgba(0,0,0,0.08);
            --radius: 16px;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft Yahei', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1, h2, h3 { margin: 0; font-weight: 600; }
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            transition: transform 0.3s ease;
        }
        .card:hover { transform: translateY(-5px); }

        /* è®¡ç®—å™¨æ ·å¼ */
        .calc-header { text-align: center; margin-bottom: 25px; }
        .calc-header h2 { color: var(--primary); margin-bottom: 8px; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .gender-group { grid-column: span 2; display: flex; gap: 15px; justify-content: center; }
        .radio-label { flex: 1; text-align: center; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; transition: all 0.3s; font-weight: bold; color: var(--text-sub); }
        .radio-label input { display: none; }
        .radio-label:has(input:checked) { border-color: var(--primary); background-color: #e8f5e9; color: var(--primary); }
        .styled-input, .styled-select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1em; background: #fafafa; outline: none; transition: border 0.3s; }
        .full-width { grid-column: span 2; }
        .btn-calc { width: 100%; padding: 16px; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; border: none; border-radius: 30px; font-size: 1.1em; font-weight: bold; cursor: pointer; margin-top: 20px; box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4); transition: transform 0.2s, box-shadow 0.2s; }
        .btn-calc:active { transform: scale(0.98); }

        /* ç»“æœå±•ç¤ºæ ·å¼ */
        .result-section { display: none; text-align: center; animation: fadeIn 0.8s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .calories-display { background: var(--primary); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
        .big-number { font-size: 2.5em; font-weight: 800; line-height: 1.2; }
        .nutrients-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .prot-color { color: #3498db; }
        .fat-color { color: #f1c40f; }
        .carb-color { color: #e67e22; }

        /* æ–°å¢ï¼šæ¨èåˆ—è¡¨æ ·å¼ */
        .recommendation-grid {
            margin-top: 15px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        .rec-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .rec-item strong {
            font-size: 1.1em;
            color: var(--primary-dark);
        }
        .rec-item span {
            font-weight: 600;
            color: var(--text-main);
        }

        /* é£Ÿç‰©åˆ†ç±»å¯¼èˆªæ ·å¼ */
        .nav-wrapper { overflow-x: auto; white-space: nowrap; padding-bottom: 10px; scrollbar-width: none; }
        .food-tabs { display: inline-flex; gap: 10px; }
        .tab-btn { flex-shrink: 0; padding: 10px 20px; background: transparent; border: 2px solid #e0e0e0; border-radius: 25px; color: var(--text-sub); cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .tab-btn.active, .tab-btn:hover { border-color: var(--primary); background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3); }
        .guide-card { border-left: 5px solid var(--primary); }

    </style>
</head>
<body>

<div class="container">

    <section class="card">
        <div class="calc-header">
            <h2>ğŸ¥— è¥å…»éœ€æ±‚è®¡ç®—å™¨</h2>
            <p>åŸºäºæ‚¨çš„èº«ä½“æ•°æ®ï¼Œç§‘å­¦è§„åˆ’æ¯æ—¥æ‘„å…¥</p>
        </div>

        <form id="calcForm" onsubmit="event.preventDefault(); showResults();">
            <div class="form-grid">
                <div class="gender-group">
                    <label class="radio-label"><input type="radio" name="gender" value="male" id="genderMale" checked><span>ğŸ‘¨ ç”·å£«</span></label>
                    <label class="radio-label"><input type="radio" name="gender" value="female" id="genderFemale"><span>ğŸ‘© å¥³å£«</span></label>
                </div>
                <div class="input-group"><label>å¹´é¾„ (å²)</label><input type="number" class="styled-input" id="ageInput" placeholder="25" required min="10"></div>
                <div class="input-group"><label>ä½“é‡ (kg)</label><input type="number" class="styled-input" id="weightInput" placeholder="60" required min="30"></div>
                <div class="input-group full-width"><label>èº«é«˜ (cm)</label><input type="number" class="styled-input" id="heightInput" placeholder="170" required min="100"></div>
                <div class="input-group full-width">
                    <label>æ—¥å¸¸æ´»åŠ¨å¼ºåº¦</label>
                    <select class="styled-select" id="activitySelect">
                        <option value="1.2">ğŸ›‹ï¸ ä¹…åä¸åŠ¨ (åŠå…¬å®¤å·¥ä½œ)</option>
                        <option value="1.375">ğŸš¶â€â™‚ï¸ è½»åº¦æ´»åŠ¨ (æ¯å‘¨è¿åŠ¨1-3æ¬¡)</option>
                        <option value="1.55">ğŸƒâ€â™‚ï¸ ä¸­åº¦æ´»åŠ¨ (æ¯å‘¨è¿åŠ¨3-5æ¬¡)</option>
                        <option value="1.725">ğŸ‹ï¸â€â™‚ï¸ é«˜å¼ºåº¦æ´»åŠ¨ (æ¯å¤©è¿åŠ¨)</option>
                    </select>
                </div>
            </div>

            <button class="btn-calc" type="submit">å¼€å§‹è®¡ç®— / LET'S DO IT</button>
        </form>
    </section>

    <section id="resultCard" class="card result-section">
        <h3>âœ¨ æ‚¨çš„ä¸“å±è¥å…»å»ºè®®</h3>
        <p style="color:#666; font-size:0.9em; margin-bottom:15px;">ç»´æŒå½“å‰ä½“é‡æ¯æ—¥æ¨èæ‘„å…¥ï¼š</p>
        
        <div class="calories-display">
            <span class="big-number" id="tdeeResult">0</span> kcal
            <div style="font-size:0.8em; opacity:0.8;">æ¯æ—¥çƒ­é‡</div>
        </div>

        <div class="nutrients-grid">
            <div class="nutrient-box"><span class="nutrient-val prot-color" id="proteinResult">0g</span><span class="nutrient-lbl">è›‹ç™½è´¨</span></div>
            <div class="nutrient-box"><span class="nutrient-val fat-color" id="fatResult">0g</span><span class="nutrient-lbl">è„‚è‚ª</span></div>
            <div class="nutrient-box"><span class="nutrient-val carb-color" id="carbResult">0g</span><span class="nutrient-lbl">ç¢³æ°´</span></div>
        </div>
    </section>
    
    <section id="recommendationCard" class="card result-section" style="display: none;">
        <h3>ğŸ½ï¸ æ¨èé£Ÿç‰©æ­é…ç¤ºä¾‹</h3>
        <p style="color:#666; font-size:0.9em; margin-bottom:15px;">ä»¥ä¸‹æ­é…ç¤ºä¾‹å¯å¤§è‡´æ»¡è¶³æ‚¨çš„æ¯æ—¥å®é‡è¥å…»ç´ éœ€æ±‚ï¼š</p>
        
        <div id="mealPlanOutput" class="recommendation-grid">
            </div>
    </section>

    <section class="card">
        <h3 style="margin-bottom: 15px;">ğŸ é£Ÿç‰©åˆ†ç±»æŒ‡å—</h3>
        
        <div class="nav-wrapper">
            <div class="food-tabs">
                <button class="tab-btn active" onclick="switchTab(this, 'all')">å…¨éƒ¨æŒ‡å—</button>
                <button class="tab-btn" onclick="switchTab(this, 'grain')">ğŸŒ¾ è°·è–¯ç±»</button>
                <button class="tab-btn" onclick="switchTab(this, 'vege')">ğŸ è”¬æœç±»</button>
                <button class="tab-btn" onclick="switchTab(this, 'meat')">ğŸ¥© ç•œç¦½è‚‰è›‹</button>
                <button class="tab-btn" onclick="switchTab(this, 'soy')">ğŸ¥› å¥¶è±†åšæœ</button>
            </div>
        </div>

        <div id="foodContent" class="food-content-detail">
             <div class="guide-card primary-bg">
                <h4>ğŸ‰ å¼€å¯ä½ çš„å¥åº·é£Ÿè°±</h4>
                <p>åˆç†æ­é…æ˜¯å¥åº·é¥®é£Ÿçš„å…³é”®ã€‚è†³é£ŸæŒ‡å—å»ºè®®ï¼šé£Ÿç‰©å¤šæ ·ï¼Œè°·ç±»ä¸ºä¸»ï¼Œå¤šåƒè”¬æœï¼Œé€‚é‡åƒé±¼ç¦½è›‹ç˜¦è‚‰ï¼Œå°‘ç›å°‘æ²¹ã€‚</p>
            </div>
        </div>
    </section>

</div>

<script>
    // =========================================================
    // é£Ÿç‰©æ•°æ®åº“ (FOOD_DATABASE) - æ ¸å¿ƒæ•°æ®æº
    // æ•°æ®ç»“æ„: åç§°, ç±»å‹, æ¯100g è¥å…»ç´  (å…‹), çƒ­é‡ (å¤§å¡)
    // =========================================================
    const FOOD_DATABASE = [
        // è›‹ç™½è´¨ (Protein)
        { name: "é¸¡èƒ¸è‚‰ (å»çš®)", type: "protein", P: 24, F: 1.2, C: 0, Kcal: 133 },
        { name: "é¸¡è›‹ (å…¨è›‹)", type: "protein", P: 12.6, F: 8.8, C: 0.7, Kcal: 144 },
        { name: "ä¸‰æ–‡é±¼", type: "protein", P: 20, F: 12, C: 0, Kcal: 208 },
        // ç¢³æ°´ (Carbohydrate)
        { name: "ç‡•éº¦ç‰‡", type: "carb", P: 15, F: 6.7, C: 66.9, Kcal: 389 },
        { name: "ç³™ç±³", type: "carb", P: 7.6, F: 2.5, C: 73.7, Kcal: 368 },
        { name: "çº¢è–¯ (è’¸ç†Ÿ)", type: "carb", P: 1.5, F: 0.2, C: 25, Kcal: 100 },
        // è„‚è‚ª (Fat) & å¥åº·è„‚è‚ª
        { name: "ç‰›æ²¹æœ", type: "fat", P: 2, F: 15, C: 9, Kcal: 160 },
        { name: "æ ¸æ¡ƒ", type: "fat", P: 15, F: 65, C: 14, Kcal: 654 },
        // è”¬èœ (ç”¨äºè¡¥å……è†³é£Ÿçº¤ç»´/å¾®é‡å…ƒç´ , å°‘é‡ç¢³æ°´)
        { name: "è¥¿å…°èŠ±", type: "vegetable", P: 2.8, F: 0.4, C: 6.6, Kcal: 33 },
        { name: "è èœ", type: "vegetable", P: 2.6, F: 0.3, C: 3.2, Kcal: 23 },
    ];


    // =========================================================
    // é€»è¾‘å‡½æ•°
    // =========================================================

    // æ•°å­—åŠ¨ç”»å‡½æ•° (ä¿æŒä¸å˜)
    function animateValue(id, start, end, duration) {
        const obj = document.getElementById(id);
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            let currentValue;
            if (id.includes('Result')) { 
                currentValue = (progress * (end - start) + start).toFixed(1);
            } else {
                currentValue = Math.floor(progress * (end - start) + start);
            }
            obj.innerText = currentValue.toLocaleString() + (id.includes('Result') && id !== 'tdeeResult' ? 'g' : '');

            if (progress < 1) {
                window.requestAnimationFrame(step);
            } else {
                 if (!id.includes('Result')) {
                    obj.innerText = Math.round(end).toLocaleString();
                 } else {
                    obj.innerText = end.toFixed(1) + 'g';
                 }
            }
        };
        window.requestAnimationFrame(step);
    }
    
    // æ ¸å¿ƒè®¡ç®—å…¬å¼ (TDEE/BMR/å®é‡è¥å…»ç´ )
    function showResults() {
        const age = parseFloat(document.getElementById('ageInput').value);
        const weight = parseFloat(document.getElementById('weightInput').value);
        const height = parseFloat(document.getElementById('heightInput').value);
        const activityFactor = parseFloat(document.getElementById('activitySelect').value);
        const genderMale = document.getElementById('genderMale').checked;
        
        if (isNaN(age) || isNaN(weight) || isNaN(height) || age < 10 || weight < 30 || height < 100) {
            alert("è¯·å¡«å†™æœ‰æ•ˆçš„å¹´é¾„ã€ä½“é‡å’Œèº«é«˜ä¿¡æ¯ï¼");
            return;
        }

        let BMR;
        if (genderMale) {
            BMR = (10 * weight) + (6.25 * height) - (5 * age) + 5;
        } else {
            BMR = (10 * weight) + (6.25 * height) - (5 * age) - 161;
        }
        
        const TDEE = BMR * activityFactor;
        
        const proteinCal = TDEE * 0.25;
        const proteinGrams = proteinCal / 4;
        const fatCal = TDEE * 0.25;
        const fatGrams = fatCal / 9;
        const carbCal = TDEE * 0.50;
        const carbGrams = carbCal / 4;

        
        // 5. æ›´æ–° UI å¹¶æ‰§è¡ŒåŠ¨ç”»
        const resultCard = document.getElementById('resultCard');
        const recommendationCard = document.getElementById('recommendationCard');
        resultCard.style.display = 'block';
        recommendationCard.style.display = 'block';
        resultCard.scrollIntoView({ behavior: 'smooth' });

        animateValue('tdeeResult', 0, TDEE, 1500);
        animateValue('proteinResult', 0, proteinGrams, 1500);
        animateValue('fatResult', 0, fatGrams, 1500);
        animateValue('carbResult', 0, carbGrams, 1500);
        
        // **è°ƒç”¨æ–°çš„æ¨èå‡½æ•°**
        generateMealPlan({
            P: proteinGrams, 
            F: fatGrams, 
            C: carbGrams
        });
    }

    // é£Ÿç‰©æ­é…ç®—æ³• (æ ¹æ®å®é‡è¥å…»ç´ ç›®æ ‡åæ¨é£Ÿç‰©ä»½é‡)
    function generateMealPlan(targets) {
        const outputDiv = document.getElementById('mealPlanOutput');
        outputDiv.innerHTML = '';
        
        let planHtml = '';

        // --- 1. è›‹ç™½è´¨æ¨è ---
        const leanProtein = FOOD_DATABASE.find(f => f.name.includes("é¸¡èƒ¸è‚‰"));
        // å‡è®¾æ¯æ—¥è›‹ç™½è´¨éœ€æ±‚çš„ 60% é€šè¿‡é¸¡èƒ¸è‚‰æ»¡è¶³
        const targetProteinGrams = targets.P * 0.6; 
        const chickenServingGrams = (targetProteinGrams / leanProtein.P) * 100;

        planHtml += `
            <div class="rec-item">
                <strong>ğŸ¥© è›‹ç™½è´¨æ¥æº</strong>
                <span>${leanProtein.name}</span>
                <span>çº¦ ${Math.round(chickenServingGrams)}g</span>
            </div>
        `;
        
        // --- 2. ç¢³æ°´åŒ–åˆç‰©æ¨è ---
        const wholeGrain = FOOD_DATABASE.find(f => f.name.includes("ç‡•éº¦ç‰‡"));
        // å‡è®¾æ¯æ—¥ç¢³æ°´éœ€æ±‚çš„ 40% é€šè¿‡ç‡•éº¦æ»¡è¶³
        const targetCarbGrams = targets.C * 0.4;
        const oatServingGrams = (targetCarbGrams / wholeGrain.C) * 100;
        
        planHtml += `
            <div class="rec-item">
                <strong>ğŸš ç¢³æ°´åŒ–åˆç‰©æ¥æº</strong>
                <span>${wholeGrain.name}</span>
                <span>çº¦ ${Math.round(oatServingGrams)}g</span>
            </div>
        `;
        
        // --- 3. è„‚è‚ªæ¨è ---
        const healthyFat = FOOD_DATABASE.find(f => f.name.includes("æ ¸æ¡ƒ"));
        // å‡è®¾æ¯æ—¥è„‚è‚ªéœ€æ±‚çš„ 15% é€šè¿‡æ ¸æ¡ƒæ»¡è¶³
        const targetFatGrams = targets.F * 0.15; 
        const nutServingGrams = (targetFatGrams / healthyFat.F) * 100;

        planHtml += `
            <div class="rec-item">
                <strong>ğŸ¥‘ å¥åº·è„‚è‚ªæ¥æº</strong>
                <span>${healthyFat.name}</span>
                <span>çº¦ ${Math.round(nutServingGrams)}g</span>
            </div>
        `;

        // --- 4. è”¬èœå’Œæ°´åˆ† (å›ºå®šæ¨è) ---
        planHtml += `
            <div class="rec-item">
                <strong>ğŸ¥¦ ç»´ç”Ÿç´ ä¸çº¤ç»´</strong>
                <span>${FOOD_DATABASE.find(f => f.type === "vegetable").name}</span>
                <span>çº¦ 300g - 500g</span>
            </div>
            <div class="rec-item">
                <strong>ğŸ’§ æ°´åˆ†æ‘„å…¥</strong>
                <span>çº¯å‡€æ°´/èŒ¶</span>
                <span>çº¦ 2000ml/æ—¥</span>
            </div>
        `;
        
        outputDiv.innerHTML = planHtml;
    }


    // å¯¼èˆªåˆ‡æ¢é€»è¾‘ (ä¿æŒä¸å˜)
    function switchTab(btn, category) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const content = document.getElementById('foodContent');

        const textMap = {
            'all': `<div class="guide-card"><h4>ğŸ‰ è†³é£ŸæŒ‡å—å…«é¡¹åŸåˆ™</h4><ul><li>é£Ÿç‰©å¤šæ ·ï¼Œè°·ç±»ä¸ºä¸»ï¼Œç²—ç»†æ­é…ã€‚</li><li>å¤šåƒè”¬æœã€å¥¶ç±»ã€å¤§è±†ã€‚</li><li>é€‚é‡åƒé±¼ã€ç¦½ã€è›‹ã€ç˜¦è‚‰ã€‚</li><li>å°‘ç›ã€å°‘æ²¹ï¼Œæ§ç³–ã€é™é…’ã€‚</li></ul></div>`,
            'grain': `<div class="guide-card"><h4>ğŸŒ¾ è°·è–¯ç±»ï¼šèƒ½é‡çš„åŸºç¡€</h4><ul><li>**æ¨èæ‘„å…¥é‡ï¼š** æ¯å¤© 250g - 400gã€‚</li><li>**ä¼˜é€‰ç§ç±»ï¼š** ç³™ç±³ã€ç‡•éº¦ã€å…¨éº¦ã€‚</li><li>**æ­é…åŸåˆ™ï¼š** å…¨è°·ç‰©å’Œæ‚è±†ç±»åº”å ä¸»é£Ÿçš„ 1/3ã€‚</li></ul><p class="tip">ğŸ’¡ å»ºè®®å°†éƒ¨åˆ†ç²¾ç±³ç™½é¢æ›¿æ¢ä¸ºç²—ç²®ã€‚</p></div>`,
            'vege': `<div class="guide-card"><h4>ğŸ è”¬æœç±»ï¼šç»´ç”Ÿç´ å’Œçº¤ç»´çš„æ¥æº</h4><ul><li>**è”¬èœç›®æ ‡ï¼š** æ¯å¤©è‡³å°‘ 300g - 500gã€‚</li><li>**æ·±è‰²ä¼˜å…ˆï¼š** æ·±è‰²è”¬èœåº”å è”¬èœæ€»é‡çš„ä¸€åŠã€‚</li><li>**æ°´æœé€‚é‡ï¼š** æ¯å¤© 200g - 350g ä¸ºå®œã€‚</li></ul><p class="tip">ğŸ’¡ è”¬èœç…®ç†Ÿä¼šæŸå¤±éƒ¨åˆ†ç»´ç”Ÿç´ Cï¼Œå»ºè®®æ¯å¤©ç”Ÿåƒé€‚é‡è”¬èœã€‚</p></div>`,
            'meat': `<div class="guide-card"><h4>ğŸ¥© ç•œç¦½è‚‰è›‹ï¼šä¼˜è´¨è›‹ç™½è´¨</h4><ul><li>**ä¼˜å…ˆé¡ºåºï¼š** é±¼è™¾ > ç¦½è‚‰ > ç•œè‚‰ã€‚</li><li>**è›‹ç±»æ‘„å…¥ï¼š** æ¯å¤©ä¸€ä¸ªé¸¡è›‹ã€‚</li><li>**æ€»é‡æ§åˆ¶ï¼š** æ¯å¤©æ€»å…±æ‘„å…¥ 120g - 200g é±¼ç¦½è›‹ç˜¦è‚‰ã€‚</li></ul><p class="tip">ğŸ’¡ çƒ¹é¥ªæ—¶å°½é‡é‡‡ç”¨è’¸ã€ç…®ã€ç‚–ç­‰æ–¹å¼ï¼Œå°‘ç”¨æ²¹ç‚¸ã€‚</p></div>`,
            'soy': `<div class="guide-card"><h4>ğŸ¥› å¥¶è±†åšæœï¼šè¡¥é’™å’Œå¥åº·æ²¹è„‚</h4><ul><li>**å¥¶ç±»æ‘„å…¥ï¼š** æ¯å¤© 300g æ¶²æ€å¥¶ã€‚</li><li>**å¤§è±†ç±»ï¼š** æ¯å¤© 25g - 35g å¤§è±†ï¼ˆæˆ–ç­‰é‡è±†è…ï¼‰ã€‚</li><li>**åšæœé™åˆ¶ï¼š** æ¯å¤©ä»…é™ä¸€å°æŠŠï¼ˆçº¦ 10gï¼‰ã€‚</li></ul><p class="tip">ğŸ’¡ è±†åˆ¶å“æ˜¯ç´ é£Ÿè€…çš„ä¸»è¦è›‹ç™½è´¨æ¥æºï¼Œåšæœè®°å¾—é€‰æ‹©åŸå‘³ã€éæ²¹ç‚¸çš„ã€‚</p></div>`
        };
        
        content.innerHTML = textMap[category];
    }

    document.addEventListener('DOMContentLoaded', () => {
        const defaultTabButton = document.querySelector('.food-tabs .tab-btn.active');
        if (defaultTabButton) {
            defaultTabButton.click();
        }
    });
</script>

</body>
</html>